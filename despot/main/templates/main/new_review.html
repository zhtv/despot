{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link rel="stylesheet" href="{% static 'media.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Prosto+One&display=swap" rel="stylesheet">
    <title>Д Е С П О Т</title>
</head>
<body>
    <main>
        <div class="main_left">
            <div class="logo">
                <a href="{% url 'index' %}"><img src="{% static 'img/logo.png' %}"></a>
                <a>Деспот</a>
            </div>

            <div class="nav">
                <a href="{% url 'reviews' %}">Все отзывы</a>
                {% if user.is_authenticated %}
                    <a href="{% url 'new_review' %}">Оставить отзыв...</a>
                {% else %}
                    <a href="{% url 'auth' %}">Оставить отзыв...</a>
                {% endif %}
                <a href="{% url 'heroes' %}">Досье</a>
                <a href="{% url 'search' %}">Поиск и розыск</a>

                {% if user.is_authenticated %}
                    <span>Вы вошли как: {{ user.username }}</span>
                    <a href="{% url 'logout' %}">Выйти</a>
                {% endif %}
            </div>            
            
            <div class="advertisement">
                <img src="{% static 'img/advert.gif' %}">
            </div>
        </div>

        <div class="main_center">
            <div class="base">
                <div class="hello red_block font-2">
                    <a>Добро пожаловать в Деспот!</a>
                </div>
                <div class="state blue_block font-125">
                    <a>Вы находитесь в штате: Анжеро</a>
                </div>
            </div>

            <div class="info">
                <div class="info_text_blocks">
                    <div class="info_text red_block mon font-125">
                        <a>Упали с лестницы? Заметили подозрительного человека в торговном центре? 
                            Ваша кошка залезла на дерево? Не беда!</a>
                    </div>
                    <div class="info_text red_block mon font-125">
                        <a>Свяжитесь с отделом <b>Деспота</b>, и вам на помощь придут квалифицированные герои!</a>
                    </div>
                    <div class="info_text red_block mon font-125">
                        <a><b>Экстренные номера:</b></a><br>
                        <a>242 <b>/</b> 646</a><br><br>
                        <a><b>Отдел качества:</b></a><br>
                        <a>+7(921)124-67-68 <b>/</b> +7(913)808-56-12</a>
                    </div>
                </div>
                
                <div class="info_image blue_block">
                    <img src="{% static 'img/cop.jpg' %}">
                </div>
            </div>
        </div>

        <div class="main_right">
            <div class="main_right_name font-2">
                <a>Оставить отзыв</a>
                <span class="mon">Обязательные поля помечены <span class="white_star">*</span></span>
            </div>
            
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                
                <div class="form_group mon font-15">
                    <label>Имя<span class="white_star">*</span></label>
                    {{ form.name }}
                    {% if form.name.errors %}
                        <div>{{ form.name.errors }}</div>
                    {% endif %}
                </div>
                
                <!-- Поле для даты (из формы Django) -->
                <div class="form_group mon font-15">
                    <label>Дата и время отзыва</label>
                    {{ form.created_at }}
                    {% if form.created_at.errors %}
                        <div>{{ form.created_at.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form_group mon font-15">
                    <label>Общая оценка<span class="white_star">*</span></label>
                    {{ form.overall_rating }}
                    {% if form.overall_rating.errors %}
                        <div>{{ form.overall_rating.errors }}</div>
                    {% endif %}
                </div>
                
                <!-- Динамические поля для героев -->
                {% for hero in active_heroes %}
                <div class="form_group mon font-15">
                    <label>Оценка {% if hero.aka %}{{ hero.aka }}{% else %}{{ hero.first_name }} {{ hero.last_name }}{% endif %}</label>
                    {% if hero.position == 1 %}
                        {{ form.hero1_rating }}
                    {% elif hero.position == 2 %}
                        {{ form.hero2_rating }}
                    {% elif hero.position == 3 %}
                        {{ form.hero3_rating }}
                    {% elif hero.position == 4 %}
                        {{ form.hero4_rating }}
                    {% elif hero.position == 5 %}
                        {{ form.hero5_rating }}
                    {% endif %}
                </div>
                {% endfor %}
                
                <!-- Если героев меньше 5, показываем оставшиеся поля как "не выбрано" -->
                {% for i in "12345" %}
                    {% with position=forloop.counter %}
                        {% if position > active_heroes|length %}
                        <div class="form_group mon font-15">
                            <label>Оценка героя {{ position }}</label>
                            {% if position == 1 %}
                                {{ form.hero1_rating }}
                            {% elif position == 2 %}
                                {{ form.hero2_rating }}
                            {% elif position == 3 %}
                                {{ form.hero3_rating }}
                            {% elif position == 4 %}
                                {{ form.hero4_rating }}
                            {% elif position == 5 %}
                                {{ form.hero5_rating }}
                            {% endif %}
                        </div>
                        {% endif %}
                    {% endwith %}
                {% endfor %}
                
                <div class="form_group mon font-15">
                    <label>Как всё прошло?<span class="white_star">*</span></label>
                    {{ form.text }}
                    {% if form.text.errors %}
                        <div>{{ form.text.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form_group mon font-15">
                    <label>Фото на память :)</label>
                    {{ form.photo }}
                </div>
                
                <button type="submit" class="red_button font-15">Отправить отзыв</button>
            </form>
        </div>
    </main>
    
</body>
</html>